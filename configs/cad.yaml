name: continual anomaly detection

# ============================================================
# DATASET SETTINGS
# ============================================================
datasets:
  - name: mvtec_ad                # Primary dataset
    data_dir: ./data/mvtec        # Path to your MVTec AD folder
    image_size: 224
    num_workers: 4
    data_incre_setting: mul       # 3+3+3+3+3
    n_classes_per_task: 3
    n_tasks: 5                    # 15 categories → 5 tasks of 3 classes each
    dataset_order: 1
    strong_augmentation: True
    random_aug: False

  - name: mvtec_loco              # Secondary dataset
    data_dir: ./data/mvtec_loco   # Path to MVTec LOCO dataset
    image_size: 224
    num_workers: 4
    data_incre_setting: mul
    n_classes_per_task: 1
    n_tasks: 5                    # 5 categories total → 5 tasks
    dataset_order: 2
    strong_augmentation: True
    random_aug: False


# ============================================================
# MODEL SETTINGS
# ============================================================
model:
  name: vit
  pretrained: True
  method: dne
  fix_head: True
  with_dne: True
  with_embeds: True
  buffer_size: 200

  # cflow/flow-based settings (safe to keep default)
  n_feat: 304
  fc_internal: 1024
  n_coupling_blocks: 4
  clamp: 3
  n_scales: 3


# ============================================================
# TRAINING SETTINGS
# ============================================================
train:
  optimizer:
    name: adam
    weight_decay: 0.00003
    momentum: 0.9
  warmup_epochs: 10
  warmup_lr: 0
  base_lr: 0.0001
  final_lr: 0
  num_epochs: 50
  batch_size: 32
  test_epochs: 10
  alpha: 0.4
  beta: 0.5
  num_classes: 2


# ============================================================
# EVALUATION SETTINGS
# ============================================================
eval:
  eval_classifier: density   # density, head
  batch_size: 32
  visualization: True        # enable heatmap visualization
  save_results: True         # save accuracy matrix and backward transfer


